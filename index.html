<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MyShop | Definitive Tech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>body { font-family: 'Inter', sans-serif; }</style>
</head>
<body class="bg-[#0f1115] text-slate-200 antialiased">

<nav class="flex justify-between items-center px-8 py-6 border-b border-white/5 sticky top-0 bg-[#0f1115]/80 backdrop-blur-md z-50">
  <div class="text-2xl font-extrabold tracking-tighter text-white">MY<span class="text-emerald-500">SHOP</span></div>
  <div class="hidden md:flex space-x-10 text-sm font-medium tracking-widest uppercase">
    <a href="index.html" class="text-emerald-400">Home</a>
    <a href="products.html" class="hover:text-emerald-400 transition">Products</a>
    <a href="cart.html" class="hover:text-emerald-400 transition">Cart</a>
  </div>
  <div class="flex items-center space-x-6">
    <a href="login.html" id="user-display" class="text-sm font-semibold hover:text-white transition">Sign In</a>
    <a href="register.html" id="auth-btn" class="bg-emerald-600 hover:bg-emerald-500 text-white px-5 py-2 rounded-full text-sm font-bold transition">Get Started</a>
  </div>
</nav>

<section class="relative overflow-hidden px-8 py-24 md:py-40">
  <div class="max-w-7xl mx-auto grid md:grid-cols-2 gap-12 items-center">
    <div>
      <h2 class="text-6xl md:text-8xl font-extrabold text-white leading-none">Future <br> <span class="text-slate-500">Standard.</span></h2>
      <p id="welcome-text" class="mt-8 text-lg text-slate-400">Curating the world's most advanced hardware.</p>
    </div>
    <img src="https://images.unsplash.com/photo-1517336714731-489689fd1ca8" class="rounded-2xl grayscale" alt="Tech" />
  </div>
</section>

<script src="js/api.js"></script>
<script>
  async function checkAuth() {
    const display = document.getElementById('user-display');
    const authBtn = document.getElementById('auth-btn');
    const welcome = document.getElementById('welcome-text');

    let localData = JSON.parse(localStorage.getItem("manualUser"));

    try {
      const response = await fetch(USER_INFO_API, { credentials: 'include' });
      if (response.ok) {
        const user = await response.json();
        if (user.name || user.given_name) {
          const name = user.given_name || user.name || (localData ? localData.name : "Operator");
          const email = user.email || (localData ? localData.email : null);
          localData = { name, email };
          localStorage.setItem("manualUser", JSON.stringify(localData));
        }
      }
    } catch (err) { console.log("Offline or local-only session."); }

    if (localData && localData.name) {
      const firstName = localData.name.split(' ')[0];
      if (display) { display.innerHTML = `<span class="text-emerald-400 font-bold">Hi, ${firstName}</span>`; }
      if (welcome) { welcome.innerText = `Welcome back, ${firstName}. Your collection is live.`; }
      if (authBtn) {
        authBtn.innerText = "Logout";
        authBtn.className = "bg-red-900/40 hover:bg-red-800 text-white px-5 py-2 rounded-full text-sm font-bold transition border border-red-500/20";
        authBtn.onclick = (e) => {
          e.preventDefault();
          localStorage.removeItem("manualUser"); 
          localStorage.removeItem("cart"); // Clear cart on logout
          alert("System: Session Terminated.");
          window.location.href = "login.html"; // Redirect to login
        };
      }
    }
  }
  document.addEventListener('DOMContentLoaded', checkAuth);
</script>
</body>
</html>